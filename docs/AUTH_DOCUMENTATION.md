# Документация по авторизации и регистрации в системе AMS-IT

## Содержание
1. [Структура базы данных](#структура-базы-данных)
2. [Функциональность страниц](#функциональность-страниц)
3. [Серверные контроллеры](#серверные-контроллеры)
4. [API маршруты](#api-маршруты)
5. [Процесс регистрации](#процесс-регистрации)

## Структура базы данных

### Таблица `users`
Основная таблица для хранения информации о пользователях:

| Поле | Тип | Описание |
|------|-----|----------|
| `id` | INT | Первичный ключ |
| `username` | VARCHAR | Логин пользователя |
| `password` | VARCHAR | Хэшированный пароль |
| `role` | ENUM | Роль пользователя |

**Возможные роли пользователей:**
- `super_admin` - Суперадминистратор
- `it` - ИТ-специалист 
- `accountant` - Бухгалтер
- `repair_commission` - Ремонтная комиссия
- `mol` - Материально ответственное лицо

## Функциональность страниц

### Страница авторизации
- Позволяет существующим пользователям войти в систему
- Поля для ввода: логин (`username`) и пароль
- После успешной авторизации пользователь получает JWT-токен

### Страница регистрации
- Доступна только при первом запуске системы, когда в БД нет пользователей
- После создания первого пользователя регистрация становится недоступной
- Все последующие пользователи создаются через административный интерфейс
- Поля для регистрации: логин, пароль, роль пользователя

### Форма добавления пользователя
- Доступна только для пользователей с административными правами
- Позволяет создавать новых пользователей с выбором роли
- Содержит валидацию полей ввода

## Серверные контроллеры

### `authController.js`
Обрабатывает авторизацию и регистрацию пользователей:
- `login` - авторизация существующего пользователя
- `register` - регистрация нового пользователя
- `getMe` - получение информации о текущем авторизованном пользователе

### `userController.js`
Управляет пользователями в системе:
- `getAllUsers` - получение списка всех пользователей
- `createUser` - создание нового пользователя (через админ-панель)
- `updateUser` - обновление данных существующего пользователя
- `deleteUser` - удаление пользователя

## API маршруты

### Авторизация и регистрация
- `POST /api/auth/login` - авторизация пользователя
- `POST /api/auth/register` - регистрация нового пользователя
- `GET /api/auth/me` - получение данных текущего пользователя

### Управление пользователями
- `GET /api/users` - получение списка всех пользователей
- `POST /api/users` - создание нового пользователя
- `PUT /api/users/:id` - обновление пользователя
- `DELETE /api/users/:id` - удаление пользователя

## Процесс регистрации

Процесс регистрации первого пользователя:
1. При первом запуске системы доступна форма регистрации
2. Пользователь вводит логин, пароль и выбирает роль
3. Данные отправляются на сервер через `POST /api/auth/register`
4. Сервер проверяет, что в базе нет других пользователей
5. Если пользователей нет, создается новый пользователь с указанными данными
6. Пароль хэшируется перед сохранением в базу данных
7. После создания первого пользователя регистрация становится недоступной

### Важные технические особенности
- На фронтенде поле для логина называется `login`, но в базе данных — `username`
- Контроллеры адаптированы для работы с этим несоответствием
- Роли пользователей строго соответствуют ENUM в базе данных: 'super_admin', 'it', 'accountant', 'repair_commission', 'mol' 